# Audit

SHAR writes an append-only JSONL audit log.

## Events

- `start`
- `stdout`
- `stderr`
- `policy_denied`
- `limit_hit`
- `limit_unenforced`
- `error`
- `exit`

Every event includes the `run_hash`.

## Event details

- `limit_hit` is emitted when an enforced limit is reached.
- `limit_unenforced` is emitted when a limit is configured but not enforced.
- `error` is emitted on verification failures and other hard errors.

## start event fields

The `start` event includes `signature` and optional `signature_verified` when a signature is present.

## run_hash

`run_hash = sha256(wasm bytes + policy manifest + SHAR version)`

## Determinism

- Event emission order is stable and append-only.
- JSON key order is stable due to typed struct serialization.
